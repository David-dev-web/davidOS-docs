<!-- 3. JavaScript (FINALE VERSION): Die Logik, die wartet, bis alles bereit ist -->
<script>
  // Wir packen alles in eine Funktion, um sicher zu sein
  function initializeThemeBanner() {
    const banner = document.getElementById('theme-banner');
    const lightBtn = document.getElementById('light-mode-btn');
    const darkBtn = document.getElementById('dark-mode-btn');

    // Prüfe, ob das Theme-Objekt (jtd) überhaupt existiert.
    if (typeof jtd === 'undefined') {
      console.error("Just the Docs theme script (jtd) not found. Banner cannot function.");
      return; // Beende das Skript, wenn das Theme nicht da ist.
    }

    function chooseTheme(theme) {
      jtd.setTheme(theme);
      localStorage.setItem('themeChoice', theme);
      banner.style.display = 'none';
    }

    lightBtn.addEventListener('click', () => chooseTheme('light'));
    darkBtn.addEventListener('click', () => chooseTheme('dark'));

    const userChoice = localStorage.getItem('themeChoice');
    if (!userChoice) {
      banner.style.display = 'block';
    }
  }

  // Der entscheidende Trick: Wir warten, bis das gesamte Fenster
  // inklusive aller Bilder und Skripte fertig geladen ist.
  window.addEventListener('load', initializeThemeBanner);
</script>
